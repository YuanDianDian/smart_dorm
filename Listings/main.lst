C51 COMPILER V9.56.0.0   MAIN                                                              04/05/2017 22:00:39 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Program Files (x86)\MDK5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRIN
                    -T(.\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "usart.h"
   2          
   3            u8 *p=NULL;
   4          u8 xdata q[]="0000FF\r\n";  //Éè±¸ºÅ 00
   5          u8 xdata event[14];   
   6          u8 xdata form[7];  //×Ô¼ºÉÏÐÐµÄÂ·ÓÉ±í
   7          code unsigned char event_zw[14]={0xF3,'0','0','0','0',0xF3,6,0xF6,0xF6,0xF6,0xF6,0xF6,0xFC,0};//×éÍøÉêÇëÖ¸
             -Áî
   8          
   9          bit zw_success;   //×éÍø³É¹¦Ö¸Áî
  10          
  11          //#define Tip_max 40  //±ÀÀ£ÈÝÈÌÉÏÏÞ
  12          
  13          u8 flag_back ;  //ÊÇ·ñÓÐÎ´´¦ÀíµÄÐÅÏ¢
  14          
  15          void main()
  16          {
  17   1        unsigned char abc;
  18   1        flag_back = 0; 
  19   1        START:
  20   1        USART_Init(); event[14]=0;  form[7]=0;
  21   1        
  22   1        for(abc=0;abc<100;abc++)
  23   1        {
  24   2          Rec_Buf[abc]=0xaa;
  25   2        }
  26   1       
  27   1        //strcpy(event,event_zw);   
  28   1        if (sendCommand(event_zw, "00FF") == Success);
  29   1        else goto START;  //ÖØÆô
  30   1      //  delay_ms(10);                             
  31   1        while(counter1<300)  //µÈ´ý1·ÖÖÓ
  32   1        {  
  33   2          if(KIND==4){ 
  34   3            if(point2>11&&Rec_Buf[point2-12]==0xf4&&Rec_Buf[point2-12+Rec_Buf[point2-12+6]]=='0'){
  35   4              if(2>1){  //È·ÈÏÊÕµ½×éÍøÏÂÐÐÖ¸Áî
  36   5                if(Rec_Buf[point2-12+3]=='0'&&Rec_Buf[point2-12+4]=='0'){   //ÊÜµ½×Ü»ú·¢ËÍµÄ×éÍøÍ¬ÒâÖ¸Áî
  37   6                    Rec_Buf[point2]=0;
  38   6                    strcpy(form,Rec_Buf+point2-12+6); CLR_Buf();  //È¡³öÂ·ÓÉ±í
  39   6                  //  form[0] -= 1;
  40   6                    strcpy(event,event_zw);  
  41   6                    q[2]=event[1];
  42   6                    q[3]=event[2];
  43   6                    event[1]=0x30;
  44   6                    event[2]=0x30;
  45   6                    SendString(q+2);     //·µ»Ø±êÊ¶  Éè±¸ºÅ+FF
  46   6                   
  47   6                    event[5] = 0xF6;     //¸æËß×Ü»úÎÒÒÑÊÕµ½Í¬ÒâÍ¨Öª
  48   6                    event[6] = 0;
  49   6                    strcat(event,form);  //Õ³Ìù½øÈ¥Â·ÓÉ±í
  50   6                    event[12]=0xFC;
  51   6                    event[1]=0xF3;       //×ª»»³ÉÉÏÐÐ×éÍøÖ¸Áî
  52   6                  //  if (sendCommand(event, "00FF") == Success);
  53   6                  //  else goto START;  //ÖØÆô  
C51 COMPILER V9.56.0.0   MAIN                                                              04/05/2017 22:00:39 PAGE 2   

  54   6                    delay_ms(10);
  55   6                    zw_success=1;       //×éÍø³É¹¦
  56   6                    TR0 = 0;   //Ö¸Ê¾µÆ²»ÔÙÉÁ
  57   6                    LED = 1;   break;
  58   6                } 
  59   5              } 
  60   4            } 
  61   3          }  
  62   2        }  // zw_success=1; LED = 1;   TR0 = 0;
  63   1        if(zw_success==0) goto START;  //ÖØÆô           
  64   1      
  65   1        if(flag_back!=0){
  66   2          if (sendCommand(event, "00FF") == Success);
  67   2           else goto START;  //ÖØÆô
  68   2          flag_back = 0;
  69   2          CLR_Buf();
  70   2        }   
  71   1      
  72   1           while(1)
  73   1        {
  74   2          switch(KIND){
  75   3            case 1:  //ÊÕµ½ÉÏÐÐÖ¸Áî
  76   3      //      if(zw_success==0) break;
  77   3              if(point2>11&&Rec_Buf[point2-12]==0xf1&&Rec_Buf[point2-12+Rec_Buf[point2-12+6]]=='0'){
  78   4                if(Rec_Buf[point2-12+6]==11||Rec_Buf[point2-12+Rec_Buf[point2-12+6]+1]==Rec_Buf[point2-12+2]){  //È·È
             -ÏÊÕµ½ÉÏÐÐÖ¸Áî
  79   5                  Rec_Buf[point2+1]=0;
  80   5                  strcpy(event,Rec_Buf+point2-12);
  81   5                  q[2]=event[1];
  82   5                  q[3]=event[2];
  83   5                  event[1]=0x30;
  84   5                  event[2]=0x30;
  85   5                  event[6] -= 1;
  86   5                  SendString(q+2);  //·µ»Ø±êÊ¶  Éè±¸ºÅ+FF
  87   5                  if (sendCommand(event, "00FF") == Success);
  88   5                  else { flag_back=1; goto START;  //ÖØÆô   else soft_reset();  //ÖØÆô
  89   6                  }
  90   5                  CLR_Buf();
  91   5                //  delay_ms(10);
  92   5                }       
  93   4              }
  94   3            KIND = 0;
  95   3            break;  
  96   3            
  97   3            case 2:  //ÊÕµ½ÏÂÐÐÖ¸Áî
  98   3      //      if(zw_success==0) break;
  99   3              if(point2>11&&Rec_Buf[point2-12]==0xf2&&Rec_Buf[point2-12+Rec_Buf[point2-12+6]]=='0'){
 100   4                if(Rec_Buf[point2-12+6]==7||Rec_Buf[point2-12+Rec_Buf[point2-12+6]-1]==Rec_Buf[point2-12+2]){
 101   5                  Rec_Buf[point2+1]=0;
 102   5                  strcpy(event,Rec_Buf+point2-12);
 103   5                  q[2]=event[1];
 104   5                  q[3]=event[2];
 105   5                  event[1]=0x30;
 106   5                  event[2]=0x30;
 107   5                  event[6] += 1;
 108   5                  SendString(q+2);  //·µ»Ø±êÊ¶  Éè±¸ºÅ+FF
 109   5                  if (sendCommand(event, "00FF") == Success);
 110   5                  else {
 111   6                    event[5]=0xf7;  //³ö´íÁË
 112   6                    event[6] -= 2;
 113   6                    event[0] = 0xf1;
 114   6                    event[12]= 0xfe;
C51 COMPILER V9.56.0.0   MAIN                                                              04/05/2017 22:00:39 PAGE 3   

 115   6                    if (sendCommand(event, "00FF") == Success);
 116   6                    else { 
 117   7                     flag_back=1; goto START;  //ÖØÆô 
 118   7                    } 
 119   6                  }
 120   5                  CLR_Buf();            
 121   5                //  delay_ms(10);
 122   5                }       
 123   4              }     
 124   3            KIND = 0;
 125   3            break;  
 126   3            
 127   3            case 3:  //ÊÕµ½×éÍøÉÏÐÐÖ¸Áî
 128   3      //      if(zw_success==0) break;
 129   3            if(point2>11&&Rec_Buf[point2-12]==0xf3&&Rec_Buf[point2-12+5]==0xF3&&Rec_Buf[point2-12+4]==Rec_Buf[point
             -2-12+2]&&Rec_Buf[point2-12+3]==Rec_Buf[point2-12+1]){  //ÊÕµ½Ä³Éè±¸µÄ×éÍøÇëÇó
 130   4                    Rec_Buf[point2+1]=0;
 131   4                    strcpy(event,Rec_Buf+point2-12);
 132   4                
 133   4                    event[6] = 0;
 134   4                    strcat(event,form);  //Õ³Ìù½øÈ¥Â·ÓÉ±í
 135   4                    event[12]=0xFC;
 136   4                    event[6] -= 1;
 137   4                
 138   4                    q[2]=event[1];
 139   4                    q[3]=event[2];
 140   4                    event[1]=0x30;
 141   4                    event[2]=0x30;
 142   4                    SendString(q+2);  //·µ»Ø±êÊ¶  Éè±¸ºÅ+FF
 143   4                    if (sendCommand(event, "00FF") == Success);
 144   4                    else { 
 145   5                    flag_back=1; goto START;  //ÖØÆô  
 146   5                    }   
 147   4                    CLR_Buf();
 148   4              //      delay_ms(10);
 149   4              } else
 150   3            if(point2>11&&Rec_Buf[point2-12]==0xf3&&Rec_Buf[point2-12+Rec_Buf[point2-12+6]]=='0'&&(Rec_Buf[point2-1
             -2+6]==11||Rec_Buf[point2-12+Rec_Buf[point2-12+6]+1]==Rec_Buf[point2-12+2])){
 151   4                Rec_Buf[point2+1]=0;
 152   4                strcpy(event,Rec_Buf+point2-12);
 153   4                q[2]=event[1];
 154   4                q[3]=event[2];
 155   4                event[1]=0x30;
 156   4                event[2]=0x30;
 157   4                event[6] -= 1;
 158   4                SendString(q+2);  //·µ»Ø±êÊ¶  Éè±¸ºÅ+FF
 159   4                if (sendCommand(event, "00FF") == Success);
 160   4                else { 
 161   5                     flag_back=1; goto START;  //ÖØÆô 
 162   5                    }   
 163   4                CLR_Buf();
 164   4             //  delay_ms(10);
 165   4            } 
 166   3            KIND = 0;
 167   3            break;  
 168   3            
 169   3            case 4:  //ÊÕµ½×éÍøÏÂÐÐÖ¸Áî
 170   3          
 171   3            if(point2>11&&Rec_Buf[point2-12]==0xf4&&Rec_Buf[point2-12+Rec_Buf[point2-12+6]]=='0'){
 172   4              if(Rec_Buf[point2-12+6]==7||\
 173   5                Rec_Buf[point2-12+Rec_Buf[point2-12+6]-1]==Rec_Buf[point2-12+2]){  //È·ÈÏÊÕµ½×éÍøÏÂÐÐÖ¸Áî
 174   5                if(Rec_Buf[point2-12+3]=='0'&&Rec_Buf[point2-12+4]=='0'){      //ÊÜµ½×Ü»ú·¢ËÍµÄ×éÍøÍ¬ÒâÖ¸Áî
C51 COMPILER V9.56.0.0   MAIN                                                              04/05/2017 22:00:39 PAGE 4   

 175   6                    Rec_Buf[point2]=0;
 176   6                    strcpy(form,Rec_Buf+point2-12+6);   //È¡³öÂ·ÓÉ±í
 177   6                  //  form[0] -= 1;
 178   6                    strcpy(event,event_zw);  
 179   6                    q[2]=event[1];
 180   6                    q[3]=event[2];
 181   6                    event[1]=0x30;
 182   6                    event[2]=0x30;
 183   6                    SendString(q+2);     //·µ»Ø±êÊ¶  Éè±¸ºÅ+FF
 184   6                  
 185   6                    event[5] = 0xF6;     //¸æËß×Ü»úÎÒÒÑÊÕµ½Í¬ÒâÍ¨Öª
 186   6                    event[6] = 0;
 187   6                    strcat(event,form);  //Õ³Ìù½øÈ¥Â·ÓÉ±í
 188   6                    event[12]=0xFC;
 189   6                    event[1]=0xF3;       //×ª»»³ÉÉÏÐÐ×éÍøÖ¸Áî
 190   6                   // if (sendCommand(event, "00FF") == Success);
 191   6                   // else goto START;  //ÖØÆô  
 192   6                //    delay_ms(10);
 193   6                    zw_success=1;       //×éÍø³É¹¦
 194   6                    TR0 = 0;   //Ö¸Ê¾µÆ²»ÔÙÉÁ
 195   6                    LED = 1;
 196   6                } else{
 197   6                  Rec_Buf[point2+1]=0;
 198   6                  strcpy(event,Rec_Buf+point2-12);
 199   6                  q[2]=event[1];
 200   6                  q[3]=event[2];
 201   6                  event[1]=0x30;
 202   6                  event[2]=0x30;
 203   6                  event[6] += 1;
 204   6                  SendString(q+2);  //·µ»Ø±êÊ¶  Éè±¸ºÅ+FF
 205   6                  if (sendCommand(event, "00FF") == Success);
 206   6                  else {
 207   7                    event[5]=0xf7;  //³ö´íÁË
 208   7                    event[6] -= 2;
 209   7                    event[0] = 0xf1;
 210   7                    event[12]= 0xfe;
 211   7                    if (sendCommand(event, "00FF") == Success);
 212   7                    else { 
 213   8                    flag_back=1; goto START;  //ÖØÆô  
 214   8                    }  
 215   7                  } 
 216   6                }
 217   5                
 218   5              } 
 219   4            } 
 220   3            
 221   3            
 222   3            
 223   3            
 224   3              
 225   3            KIND = 0;
 226   3            break;  
 227   3            
 228   3            case 5:  //²âÊÔÖ¸Áî
 229   3      //    if(zw_success==0) break;
 230   3              
 231   3            KIND = 0;
 232   3            break;  
 233   3          }
 234   2        }
 235   1      }

C51 COMPILER V9.56.0.0   MAIN                                                              04/05/2017 22:00:39 PAGE 5   


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1727    ----
   CONSTANT SIZE    =     19    ----
   XDATA SIZE       =     30    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
